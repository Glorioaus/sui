## 随手记账单格式转换工具 - 完整实现计划

### 项目概述
创建一个Python工具，将各种银行卡账单转换为随手记可导入的Excel格式，使用JSON配置文件维护分类-子分类映射。

### 技术栈
- **Python 3.8+**
- **openpyxl**：Excel文件读写
- **pandas**：数据处理
- **xlrd**：旧版Excel文件支持（.xls）
- **pdfplumber**：PDF解析

### 项目结构
```
sui/
├── README.md
├── requirements.txt
├── config/
│   └── category_mapping.json   # 分类-子分类映射配置
├── src/
│   ├── __init__.py
│   ├── models.py              # 数据模型定义
│   ├── base_parser.py         # 基础解析器类
│   ├── parsers/              # 各银行解析器
│   │   ├── __init__.py
│   │   ├── ccb_parser.py       # 建设银行
│   │   ├── abc_parser.py       # 农业银行
│   │   ├── boc_parser.py       # 宁波银行
│   │   └── citic_parser.py     # 中信银行
│   ├── excel_generator.py     # Excel生成器
│   └── main.py              # 主程序入口
├── templates/
│   └── suiji_template.xls   # 随手记导入模板
├── input/                   # 输入账单目录
└── output/                  # 输出Excel目录
```

### JSON配置文件结构（category_mapping.json）
```json
{
  "餐饮": {
    "外卖": ["美团", "饿了么", "外卖"],
    "早餐": ["早餐", "包子", "豆浆"],
    "午餐": ["午餐", "盒饭"],
    "晚餐": ["晚餐", "火锅", "烧烤"]
  },
  "交通": {
    "地铁": ["地铁", "城铁"],
    "公交": ["公交", "巴士"],
    "打车": ["滴滴", "出租车"],
    "加油": ["加油", "中石化", "中石油"]
  },
  "购物": {
    "日用品": ["超市", "沃尔玛", "家乐福"],
    "服装": ["服装", "鞋", "衣服"],
    "数码": ["手机", "电脑", "数码"]
  },
  "其他": {
    "未分类": []
  }
}
```

### 实现步骤

#### 1. 项目初始化
- 创建项目目录结构
- 生成 requirements.txt 依赖文件
- 创建 category_mapping.json 配置文件模板

#### 2. 数据模型（models.py）
- 定义统一的账单数据结构
- 包含字段：时间、分类、子分类、账户、金额、备注

#### 3. 基础解析器（base_parser.py）
- 定义抽象解析器基类
- 实现分类-子分类自动匹配逻辑
- 加载JSON配置文件

#### 4. 各银行解析器实现
- **建设银行（CCB）**：解析CSV格式，GBK编码
- **农业银行（ABC）**：解析Excel格式
- **宁波银行（BOC）**：解析Excel格式
- **中信银行（CITIC）**：解析PDF格式

#### 5. Excel生成器（excel_generator.py）
- 读取随手记模板
- 填充账单数据（正确处理分类-子分类列）
- 生成符合随手记导入格式的Excel文件

#### 6. 主程序（main.py）
- 命令行界面
- 支持单文件和批量处理
- 错误处理和日志记录

### 使用流程
1. 编辑 category_mapping.json 配置分类映射
2. 将账单文件放入 input/ 目录
3. 运行 `python src/main.py`
4. 在 output/ 目录获取生成的Excel文件
5. 导入到随手记